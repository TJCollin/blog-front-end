(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"8dKs":function(t,e,a){},Oanp:function(t,e,a){"use strict";a.r(e);var o=a("QbLZ"),r=a.n(o),s=(a("ZhHq"),a("RQ3N"),a("53J1")),i=a.n(s),n=(a("Hxq+"),a("TkuN")),l=a.n(n),c=(a("EMu8"),a("8606")),u=a.n(c),m=(a("GVEf"),a("7t/g")),d=a.n(m),f=(a("7Kd7"),a("N4fY")),g=a.n(f),p=(a("Ql/2"),a("QQVE")),h=a.n(p),v=a("stgD"),b=(a("ZOF2"),a("8SHQ")),$={name:"ArticleInfo",data:function(){return{updateTag:!1,tagList:[],form:{title:"",content:"",tags:[],abstract:""},rules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"}],tags:[{required:!0,message:"请选择文章标题",trigger:"blur"}],abstract:[{required:!0,message:"请填写活动形式",trigger:"blur"}]}}},created:function(){var e=this,t=this.$route.params.articleId;this.updateTag=!1,t&&(this.updateTag=!0,this.$axios._get("article/article",{articleId:t}).then(function(t){t.data.code?e.form=t.data.data[0]:e.$message.error(t.data.message)}).catch(function(t){console.log(t)})),this.$axios._get("tag").then(function(t){t.data.code||(e.tagList=t.data.data.res_limit)}).catch(function(t){console.log(t)})},components:{"m-editor":v.mavonEditor,"el-form":h.a,"el-form-item":g.a,"el-button":d.a,"el-input":u.a,"el-select":l.a,"el-option":i.a},methods:{imgAdd:function(a,t){var o=this,e=new FormData;e.append("file",t),this.$axios._post("img",e).then(function(t){var e=b.a.SERVER_NAME+"images/"+t.data.data.filename;o.$refs.editor.$img2Url(a,e),console.log(t)}).catch(function(t){console.log(t)})},getLocalDate:function(){var t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t},submitForm:function(){var e=this;e.$refs.articleForm.validate(function(t){if(!t)return e.$message.error("必要信息未填写完整！"),!1;e.updateTag?e.$axios._put("article/article",r()({},e.form,{updatedAt:e.getLocalDate()})).then(function(t){t.data.code?e.$message.success("文章保存成功"):e.$message.error("文章保存失败")}).catch(function(t){console.log(t)}):e.$axios._post("article/article",r()({},e.form,{updatedAt:e.getLocalDate()})).then(function(t){t.data.code?e.$message.success("文章保存成功"):e.$message.error("文章保存失败")}).catch(function(t){console.log(t)})})},resetForm:function(){this.$refs.editor.resetFields()},saveArticle:function(t,e){console.log("save",t,e)}}},_=(a("YNSQ"),a("KHd+")),x=Object(_.a)($,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("el-form",{ref:"articleForm",staticClass:"demo-form",attrs:{model:e.form,rules:e.rules,"label-position":"left"}},[a("el-form-item",{attrs:{prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"tags"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择文章标签"},model:{value:e.form.tags,callback:function(t){e.$set(e.form,"tags",t)},expression:"form.tags"}},e._l(e.tagList,function(t){return a("el-option",{key:t._id,attrs:{label:t.tagName,value:t._id}})}))],1),e._v(" "),a("el-form-item",{attrs:{prop:"abstract"}},[a("el-input",{attrs:{placeholder:"请输入文章摘要",type:"textarea"},model:{value:e.form.abstract,callback:function(t){e.$set(e.form,"abstract",t)},expression:"form.abstract"}})],1)],1),e._v(" "),a("div",{staticClass:"editor"},[a("m-editor",{ref:"editor",staticStyle:{height:"100%",width:"100%"},on:{imgAdd:e.imgAdd,save:e.saveArticle},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),a("div",{staticClass:"editor-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")])],1)],1)},[],!1,null,null,null);x.options.__file="ArticleInfo.vue",e.default=x.exports},YNSQ:function(t,e,a){"use strict";var o=a("8dKs");a.n(o).a}}]);